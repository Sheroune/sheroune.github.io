Конфигурационный файл
###############################

Основное
================

* ``gpu: 'cpu'`` - использование процессора или графического процессора
* ``run_debug_eval: false`` - запуск отладочной оценки

Сохранение модели
================
* ``weights_path: './pretrained/440000.pth.tar'`` - путь к предварительно обученным весам TTS
* ``restore_step: 0`` - шаг с которого продолжить обучение
* ``load_path: './pretrained/440000.pth.tar'`` - путь к предварительно обученным весам TTS для обучения

Вокодер hifi
================

* ``weights_path: './pretrained/hifi.pth'`` - путь к предварительно обученному вокодеру HiFi-GAN
* ``MAX_WAV_VALUE: 32768`` - максимальное значение амплитуды аудио
* ``resblock: "1"`` - количество блоков в ResNet
* ``num_gpus: 0`` - количество графических процессоров
* ``batch_size: 8`` - размер пакета обучения
* ``learning_rate: 0.0002`` - скорость обучения
* ``adam_b1: 0.8`` - коэффициент для первого момента в оптимизаторе Adam
* ``adam_b2: 0.99`` - коэффициент для второго момента в оптимизаторе Adam
* ``lr_decay: 0.999`` - скорость уменьшения скорости обучения
* ``seed: 1234`` - сид для генерации случайных чисел

* ``upsample_rates: [8,8,2,2]`` - коэффициенты повышения частоты дискретизации
* ``upsample_kernel_sizes: [16,16,4,4]`` - размеры ядра для повышения частоты дискретизации
* ``upsample_initial_channel: 512`` - количество каналов на начальном уровне повышения частоты дискретизации
* ``resblock_kernel_sizes: [3,7,11]`` - размеры ядра ResNet
* ``resblock_dilation_sizes: [[1,3,5], [1,3,5], [1,3,5]]`` - размеры диляции в блоке ResNet
* ``resblock_initial_channel: 256`` - количество каналов на начальном уровне ResNet

* ``segment_size: 8192`` - размер сегмента для обработки аудио
* ``num_mels: 80`` - количество мел-фильтров
* ``num_freq: 1025`` - количество частотных компонент в спектрограмме
* ``n_fft: 1024`` - размер окна FFT
* ``hop_size: 256`` - размер шага при перекрытии окон при обработке аудио
* ``win_size: 1024`` - размер окна при обработке аудио
* ``sampling_rate: 22050`` - частота дискретизации аудио


Тренировка
================
* ``path:`` - пути к данным:
    * ``ckpt_path``: "output/ckpt/multi_final" - путь к сохраненным параметрам модели
    * ``result_path``: "output/result/multi_final" - путь к сохраненным результатам
* ``optimizer::`` - параметры оптимизатора:
    * ``batch_size``: 16 - размер пакета для обучения модели
    * ``betas``: [0.95, 0.999] - коэффициенты бета для оптимизатора Adam
    * ``eps``: 0.00001 - эпсилон для оптимизатора Adam
    * ``weight_decay``: 0.0 - коэффициент L2 регуляризации
    * ``grad_clip_thresh``: 1.0 - порог отсечения градиента
    * ``grad_acc_step``: 4 - число шагов градиентного накопления
    * ``warm_up_step``: 4000 - число шагов "разогрева" для оптимизатора
    * ``anneal_steps``: [300000, 400000, 500000] - шаги затухания для learning rate
    * ``anneal_rate``: 0.7 - коэффициент затухания для learning rate
* ``step::`` - периоды записи в шагах данных и их количество:
    * ``total_step``: 1000000 - общее число шагов обучения
    * ``log_step``: 1000 - период шагов для записи логов
    * ``synth_step``: 10000 - период шагов для синтеза результатов
    * ``val_step``: 1000 - период шагов для валидации модели
    * ``save_step``: 10000 - период шагов для сохранения модели
* ``max_masks_per_sentence``: 0.15 - максимальное число масок в предложении


Предварительная обработка датасета
=======================================
* ``dataset: "ruslan"`` - выбор датасета, используемого для обучения модели.
* ``lexicon_path: "./rus_all.dict"`` - путь к словарю.
* ``preprocessing:`` - параметры предварительной обработки данных.
    * ``val_size: 512`` - размер валидационной выборки.
* ``text:`` - параметры текста.
    * ``text_cleaners: []`` - список функций для очистки текста.
    * ``language: "ru"`` - язык текста.
* ``sampling_rate: 22050`` - частота дискретизации аудио.
* ``max_wav_value: 32768.0`` - максимальное значение амплитуды аудио.
* ``stft:`` - параметры Short-Time Fourier Transform.
    * ``filter_length: 1024`` - длина фильтра.
    * ``hop_length: 256`` - длина шага.
    * ``win_length: 1024`` - длина окна.
* ``mel:`` - параметры Mel Spectrogram.
    * ``n_mel_channels: 80`` - количество каналов Mel Spectrogram.
    * ``mel_fmin: 0`` - минимальная частота Mel Spectrogram.
    * ``mel_fmax: 8000`` - максимальная частота Mel Spectrogram. Для HiFi-GAN вокодера значение должно быть равно 8000, для MelGAN вокодера - null.
* ``pitch:`` - параметры голоса.
    * ``feature: "phoneme_level"`` - уровень анализа звука. Поддерживает "phoneme_level" или "frame_level".
    * ``normalization: True`` - нормализация признаков.
* ``energy:`` - параметры энергии.
    * ``feature: "phoneme_level"`` - уровень анализа звука. Поддерживает "phoneme_level" или "frame_level".
    * ``normalization: True`` - нормализация признаков.

Параметры итоговой модели:
===================
* ``transformer:`` Параметры трансформера
    * ``encoder_layer: 4`` - количество слоев в энкодере
    * ``encoder_head: 2`` - количество голов в энкодере
    * ``encoder_hidden: 256`` - размер скрытого слоя в энкодере
    * ``variance_hidden: 256`` - размер скрытого слоя для предиктора вариации
    * ``decoder_layer: 6`` - количество слоев в декодере
    * ``decoder_head: 2`` - количество голов в декодере
    * ``decoder_hidden: 256`` - размер скрытого слоя в декодере
    * ``conv_filter_size: 1024`` - размер сверточного фильтра
    * ``conv_kernel_size: [9, 1]`` - размер ядра свертки в энкодере
    * ``encoder_dropout: 0.2`` - dropout значение для энкодера
    * ``decoder_dropout: 0.2`` - dropout значение для декодера
* ``variance_predictor:``
    * ``filter_size: 256`` - размер фильтра для предиктора вариации
    * ``kernel_size: 3`` - размер ядра свертки для предиктора вариации
    * ``dropout: 0.5`` - dropout значение для предиктора вариации
    * ``use_cwt: False`` - переключатель для использования CWT
* ``variance_embedding:``
    * ``pitch_quantization: "linear"`` - метод квантизации тона (поддерживается "linear" или "log", "log" допустим только если значения тона не нормализованы во время предварительной обработки)
    * ``energy_quantization: "linear"`` - метод квантизации энергии (поддерживается "linear" или "log", "log" допустим только если значения энергии не нормализованы во время предварительной обработки)
    * ``n_bins: 256`` - количество бинов для embedding слоя вариации
    * ``multi_speaker: True`` - переключатель для включения многоголосого режима
    * ``max_seq_len: 1000`` - максимальная длина последовательности
* ``vocoder:`` параметры вокодера
    * ``model: "HiFi-GAN"`` - модель вокодера (поддерживаются "HiFi-GAN" и "MelGAN")
    * ``speaker: "universal"`` - настройка диктора (поддерживаются "LJSpeech" и "universal")
    * ``use_cpu: true`` - переключатель для использования CPU
